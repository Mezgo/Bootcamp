[
{
  "model": "desktop.document2",
  "pk": 4,
  "fields": {
    "owner": [
      "instructor"
    ],
    "name": "Clase-03",
    "description": "",
    "uuid": "e66178aa-0d51-45e0-9e95-32f706d3e52a",
    "type": "query-hive",
    "data": "{\"forceHistoryInitialHeight\": false, \"loadingHistory\": false, \"schedulerViewModel\": null, \"schedulerViewModelIsLoaded\": false, \"retryModalConfirm\": null, \"uuid\": \"a9b57e1e-ffcb-4e23-8177-d5cecb3762ec\", \"initialType\": \"hive\", \"historyInitialHeight\": 2825.364032, \"selectedSnippet\": \"hive\", \"type\": \"query-hive\", \"canSave\": true, \"sessions\": [], \"updateHistoryFailed\": false, \"executingAllIndex\": 0, \"presentationSnippets\": {}, \"isHistory\": false, \"isPresentationModeDefault\": false, \"coordinatorUuid\": null, \"name\": \"Clase-02\", \"viewSchedulerId\": \"\", \"isSaved\": true, \"creatingSessionLocks\": [], \"directoryUuid\": \"\", \"unloaded\": false, \"dependentsCoordinator\": [], \"retryModalCancel\": null, \"isPresentationMode\": false, \"pubSubUrl\": null, \"snippets\": [{\"showLongOperationWarning\": false, \"wasBatchExecuted\": false, \"chartLimits\": [5, 10, 25, 50, 100], \"associatedDocumentLoading\": true, \"isReady\": true, \"compatibilitySourcePlatforms\": [{\"name\": \"Teradata\", \"value\": \"teradata\"}, {\"name\": \"Oracle\", \"value\": \"oracle\"}, {\"name\": \"Netezza\", \"value\": \"netezza\"}, {\"name\": \"Impala\", \"value\": \"impala\"}, {\"name\": \"Hive\", \"value\": \"hive\"}, {\"name\": \"DB2\", \"value\": \"db2\"}, {\"name\": \"Greenplum\", \"value\": \"greenplum\"}, {\"name\": \"MySQL\", \"value\": \"mysql\"}, {\"name\": \"PostgreSQL\", \"value\": \"postgresql\"}, {\"name\": \"Informix\", \"value\": \"informix\"}, {\"name\": \"SQL Server\", \"value\": \"sqlserver\"}, {\"name\": \"Sybase\", \"value\": \"sybase\"}, {\"name\": \"Access\", \"value\": \"access\"}, {\"name\": \"Firebird\", \"value\": \"firebird\"}, {\"name\": \"ANSISQL\", \"value\": \"ansisql\"}, {\"name\": \"Generic\", \"value\": \"generic\"}], \"statusForButtons\": \"executed\", \"hideStacked\": true, \"lastExecuted\": 1659626336854, \"showLogs\": true, \"aceCursorPosition\": {\"column\": 24, \"row\": 3}, \"lastExecutedSelectionRange\": {\"start\": {\"column\": 0, \"row\": 245}, \"end\": {\"column\": 42, \"row\": 245}}, \"lastGetLogsRequest\": {\"status\": 200, \"statusText\": \"OK\", \"readyState\": 4, \"responseJSON\": {\"status\": 0, \"progress\": 100, \"jobs\": [], \"logs\": \"\", \"isFullLogs\": false}, \"responseText\": \"{\\\"status\\\": 0, \\\"progress\\\": 100, \\\"jobs\\\": [], \\\"logs\\\": \\\"\\\", \\\"isFullLogs\\\": false}\"}, \"getLogsTimeout\": 99358, \"variableNames\": [], \"associatedDocumentUuid\": null, \"compatibilitySourcePlatform\": {\"name\": \"Hive\", \"value\": \"hive\"}, \"chartLimit\": null, \"progress\": 0, \"chartType\": \"pie\", \"isFetchingData\": false, \"name\": \"\", \"statementTypes\": [\"text\", \"file\"], \"is_redacted\": false, \"compatibilityTargetPlatform\": {\"name\": \"Hive\", \"value\": \"hive\"}, \"chartScope\": \"world\", \"result\": {\"statement_id\": 0, \"isMetaFilterVisible\": false, \"meta\": [], \"logLines\": 0, \"id\": \"19a9ac09-b443-cb7f-e1a6-66244d68db0c\", \"logs\": \"\", \"statements_count\": 1, \"rows\": \"0\", \"hasSomeResults\": false, \"filteredMetaChecked\": true, \"hasMore\": false, \"filteredMeta\": [{\"comment\": null, \"checked\": true, \"name\": \"\", \"originalIndex\": 0, \"cssClass\": \"sort-numeric\", \"type\": \"int\"}, {\"comment\": null, \"checked\": true, \"name\": \"trips_part.bikeid\", \"originalIndex\": 1, \"cssClass\": \"sort-numeric\", \"type\": \"int\"}, {\"comment\": null, \"checked\": true, \"name\": \"trips_part.checkout_time\", \"originalIndex\": 2, \"cssClass\": \"sort-string\", \"type\": \"string\"}, {\"comment\": null, \"checked\": true, \"name\": \"trips_part.duration_minutes\", \"originalIndex\": 3, \"cssClass\": \"sort-numeric\", \"type\": \"int\"}, {\"comment\": null, \"checked\": true, \"name\": \"trips_part.end_station_id\", \"originalIndex\": 4, \"cssClass\": \"sort-numeric\", \"type\": \"int\"}, {\"comment\": null, \"checked\": true, \"name\": \"trips_part.end_station_name\", \"originalIndex\": 5, \"cssClass\": \"sort-string\", \"type\": \"string\"}, {\"comment\": null, \"checked\": true, \"name\": \"trips_part.start_station_id\", \"originalIndex\": 6, \"cssClass\": \"sort-numeric\", \"type\": \"int\"}, {\"comment\": null, \"checked\": true, \"name\": \"trips_part.start_station_name\", \"originalIndex\": 7, \"cssClass\": \"sort-string\", \"type\": \"string\"}, {\"comment\": null, \"checked\": true, \"name\": \"trips_part.start_time\", \"originalIndex\": 8, \"cssClass\": \"sort-date\", \"type\": \"timestamp\"}, {\"comment\": null, \"checked\": true, \"name\": \"trips_part.subscriber_type\", \"originalIndex\": 9, \"cssClass\": \"sort-string\", \"type\": \"string\"}, {\"comment\": null, \"checked\": true, \"name\": \"trips_part.trip_id\", \"originalIndex\": 10, \"cssClass\": \"sort-numeric\", \"type\": \"bigint\"}, {\"comment\": null, \"checked\": true, \"name\": \"trips_part.year\", \"originalIndex\": 11, \"cssClass\": \"sort-numeric\", \"type\": \"int\"}, {\"comment\": null, \"checked\": true, \"name\": \"trips_part.month\", \"originalIndex\": 12, \"cssClass\": \"sort-numeric\", \"type\": \"int\"}], \"type\": \"table\", \"handle\": {\"log_context\": null, \"statements_count\": 1, \"end\": {\"column\": 40, \"row\": 0}, \"statement_id\": 0, \"has_more_statements\": false, \"start\": {\"column\": 0, \"row\": 0}, \"secret\": \"2ZeKlCjjQY+rsBA8XGxpPQ==\\n\", \"has_result_set\": true, \"session_guid\": \"T31SdeuATBiSqswCtwl0+w==\\n\", \"statement\": \"select * from trips_part where month = 12\", \"operation_type\": 0, \"modified_row_count\": null, \"guid\": \"5b1yXI8fRLSdF8j5ew3BVQ==\\n\", \"previous_statement_hash\": \"460013881b4d02d6d2f3c61fe935a77c910b59800d8c4cd2c2c4473a\"}, \"metaFilter\": {\"query\": \"\", \"facets\": {}, \"text\": []}, \"explanation\": \"\", \"statement_range\": {\"start\": {\"column\": 0, \"row\": 0}, \"end\": {\"column\": 0, \"row\": 0}}, \"startTime\": \"2022-08-04T15:18:58.417Z\", \"data\": [], \"filteredColumnCount\": 12, \"executionTime\": 1473, \"fetchedOnce\": false, \"hasResultset\": true, \"endTime\": \"2022-08-04T15:18:59.890Z\"}, \"errors\": [], \"chartMapHeat\": null, \"statement_raw\": \"-- FLIGHT DELAYS\\r\\n-- http://stat-computing.org/dataexpo/2009/the-data.html\\r\\n\\r\\nDROP TABLE flightdelays;\\r\\nCREATE EXTERNAL TABLE flightdelays(\\r\\n    year INT,\\r\\n    month INT,\\r\\n    day INT,\\r\\n    day_of_week INT,\\r\\n    dep_time INT,\\r\\n    crs_dep_time INT,\\r\\n    arr_time INT,\\r\\n    crs_arr_time INT,\\r\\n    unique_carrier STRING,\\r\\n    flight_num INT,\\r\\n    tail_num STRING,\\r\\n    actual_elapsed_time INT,\\r\\n    crs_elapsed_time INT,\\r\\n    air_time INT,\\r\\n    arr_delay INT,\\r\\n    dep_delay INT,\\r\\n    origin STRING,\\r\\n    dest STRING,\\r\\n    distance INT,\\r\\n    taxi_in INT,\\r\\n    taxi_out INT,\\r\\n    cancelled INT,\\r\\n    cancellation_code STRING,\\r\\n    diverted INT,\\r\\n    carrier_delay STRING,\\r\\n    weather_delay STRING,\\r\\n    nas_delay STRING,\\r\\n    security_delay STRING,\\r\\n    late_aircraft_delay STRING\\r\\n)\\r\\nROW FORMAT DELIMITED\\r\\nFIELDS TERMINATED BY ','\\r\\nLOCATION '/user/instructor/data/flights/flightdelays/';\\r\\n\\r\\nSELECT count(*) FROM flightdelays;\\r\\n\\r\\nshow tables;\\r\\n-- AIRPORTS\\r\\n-- http://stat-computing.org/dataexpo/2009/supplemental-data.html\\r\\nDROP TABLE airports;\\r\\nCREATE EXTERNAL TABLE airports(\\r\\n    iata STRING,\\r\\n    airport STRING,\\r\\n    city STRING,\\r\\n    state STRING,\\r\\n    country STRING,\\r\\n    lat DECIMAL(9,6),\\r\\n    long DECIMAL(9,6)\\r\\n)\\r\\nROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde'\\r\\nWITH SERDEPROPERTIES (\\r\\n    'separatorChar'=',',\\r\\n    'quoteChar'='\\\\\\\"',\\r\\n    'skip.header.line.count'='1'\\r\\n)\\r\\nLOCATION '/user/instructor/data/flights/airports/';\\r\\n\\r\\nSELECT count(*) FROM airports;\\r\\n\\r\\nSHOW TABLES;\\r\\n\\r\\nDESCRIBE FORMATTED airports;\\r\\n\\r\\nSELECT \\r\\n    ROUND(AVG(arr_delay), 2) AS avg_sfo_delay_min \\r\\nFROM \\r\\n    flightdelays \\r\\nWHERE \\r\\n    month=1 AND origin='SFO';\\r\\n\\r\\nSELECT \\r\\n    a.airport,\\r\\n    ROUND(AVG(f.arr_delay), 2) AS avg_delay_min \\r\\nFROM \\r\\n    flightdelays f \\r\\n    JOIN airports a ON f.origin = a.iata\\r\\nWHERE \\r\\n    month = 1\\r\\nGROUP BY\\r\\n    a.airport\\r\\nLIMIT 5;\\r\\n\\r\\n\\r\\n-- CTAS\\r\\n\\r\\n\\r\\nCREATE TABLE flightdelays_sfo \\r\\nAS\\r\\nSELECT\\r\\n    dep_time, \\r\\n    unique_carrier, \\r\\n    flight_num, \\r\\n    arr_delay, \\r\\n    origin, \\r\\n    dest,\\r\\n    year,\\r\\n    month,\\r\\n    day\\r\\nFROM \\r\\n    flightdelays\\r\\nWHERE\\r\\n    origin = 'SFO';\\r\\n\\r\\n\\r\\nSELECT DAY, AVG(arr_delay) AS PROM_DELAY FROM flightdelays_sfo GROUP BY DAY;\\r\\n\\r\\nDESCRIBE FORMATTED flightdelays_sfo;\\r\\n\\r\\n-- APACHE LOGS (REGEX)\\r\\n\\r\\nCREATE EXTERNAL TABLE apachelogs (\\r\\n  host STRING,\\r\\n  identity STRING,\\r\\n  user_id STRING,\\r\\n  server_time STRING,\\r\\n  request STRING,\\r\\n  status STRING,\\r\\n  size_bytes STRING\\r\\n  )\\r\\nROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.RegexSerDe'\\r\\nWITH SERDEPROPERTIES (\\r\\n  \\\"input.regex\\\" = \\\"([^ ]*) ([^ ]*) ([^ ]*) (-|\\\\\\\\[[^\\\\\\\\]]*\\\\\\\\]) ([^ \\\\\\\"]*|\\\\\\\"[^\\\\\\\"]*\\\\\\\") (-|[0-9]*) (-|[0-9]*)\\\",\\r\\n  \\\"output.format.string\\\" = \\\"%1$s %2$s %3$s %4$s %5$s %6$s %7$s\\\"\\r\\n)\\r\\nSTORED AS TEXTFILE\\r\\nLOCATION '/user/instructor/data/apachelogs/';\\r\\n\\r\\n\\r\\nSELECT * FROM apachelogs LIMIT 5;\\r\\n\\r\\n\\r\\n-- BIKE SHARE\\r\\n\\r\\ndrop table stations;\\r\\nCREATE EXTERNAL TABLE stations(\\r\\n\\tlongitude FLOAT,\\r\\n\\tlatitude FLOAT,\\r\\n\\tname STRING,\\r\\n\\tstation_id INT,\\r\\n\\tstatus STRING\\r\\n)\\r\\nROW FORMAT DELIMITED\\r\\nFIELDS TERMINATED BY ','\\r\\nLOCATION '/user/instructor/data/bikeshare/stations/'\\r\\nTBLPROPERTIES(\\r\\n    'skip.header.line.count'='1'\\r\\n);\\r\\n\\r\\n\\r\\nSELECT * FROM stations;\\r\\n\\r\\n\\r\\nCREATE EXTERNAL TABLE trips(\\r\\n\\tbikeid INT,\\r\\n\\tcheckout_time STRING,\\r\\n\\tduration_minutes INT,\\r\\n\\tend_station_id INT,\\r\\n\\tend_station_name STRING,\\r\\n\\tmonth INT,\\r\\n\\tstart_station_id INT,\\r\\n\\tstart_station_name STRING,\\r\\n\\tstart_time TIMESTAMP,\\r\\n\\tsubscriber_type STRING,\\r\\n\\ttrip_id BIGINT,\\r\\n\\tyear INT\\r\\n)\\r\\nROW FORMAT DELIMITED\\r\\nFIELDS TERMINATED BY ','\\r\\nLOCATION '/user/instructor/data/bikeshare/trips/'\\r\\nTBLPROPERTIES(\\r\\n    'skip.header.line.count'='1'\\r\\n);\\r\\n\\r\\n\\r\\nSELECT COUNT(*) FROM trips;\\r\\n\\r\\n\\r\\n-- consultar cuantos viajes se realizaron por a\\u00f1o\\r\\nSELECT t.year, count(*) FROM trips t GROUP BY t.year;\\r\\n\\r\\n\\r\\n-- completar los valores faltantes en el campo 'year'\\r\\ndrop table trips_ok;\\r\\nCREATE TABLE trips_ok\\r\\nAS\\r\\nSELECT \\r\\n    t.*, \\r\\n    CASE \\r\\n        WHEN t.year IS NULL THEN year(t.start_time) ELSE t.year \\r\\n    END AS `year_modif`,\\r\\n    CASE \\r\\n        WHEN t.month IS NULL THEN month(t.start_time) ELSE t.month \\r\\n    END AS `month_modif`\\r\\nFROM \\r\\n    trips t;\\r\\n\\r\\nSELECT t.year_modif, count(*) FROM trips_ok t GROUP BY t.year_modif;\\r\\nSELECT t.month_modif, count(*) FROM trips_ok t GROUP BY t.month_modif;\\r\\n\\r\\n-- Links recomendados: \\r\\n-- https://cwiki.apache.org/confluence/display/Hive/Tutorial\\r\\n-- https://gist.github.com/kzhangkzhang/258d18858889fa97194011a249b74c43\\r\\n\\r\\nDROP TABLE trips_part;\\r\\nCREATE EXTERNAL TABLE trips_part(\\r\\n\\tbikeid INT,\\r\\n\\tcheckout_time STRING,\\r\\n\\tduration_minutes INT,\\r\\n\\tend_station_id INT,\\r\\n\\tend_station_name STRING,\\r\\n\\tstart_station_id INT,\\r\\n\\tstart_station_name STRING,\\r\\n\\tstart_time TIMESTAMP,\\r\\n\\tsubscriber_type STRING,\\r\\n\\ttrip_id BIGINT,\\r\\n\\tyear INT\\r\\n)\\r\\nPARTITIONED BY(month INT)\\r\\nLOCATION '/user/instructor/data/bikeshare/trips_part/';\\r\\n\\r\\n-- Ejecutar de 1 a 12\\r\\nINSERT INTO trips_part\\r\\nPARTITION(month=12)\\r\\nSELECT bikeid,\\r\\n\\tcheckout_time,\\r\\n\\tduration_minutes,\\r\\n\\tend_station_id,\\r\\n\\tend_station_name,\\r\\n\\tstart_station_id,\\r\\n\\tstart_station_name,\\r\\n\\tstart_time,\\r\\n\\tsubscriber_type,\\r\\n\\ttrip_id,\\r\\n\\tyear_modif\\r\\nFROM trips_ok\\r\\nWHERE month_modif = 12;\\r\\n\\r\\nselect avg(duration_minutes) from trips_ok where month_modif = 3;\\r\\nselect avg(duration_minutes) from trips_part where month = 3;\\r\\n\\r\\nselect * from trips_part where month = 12;\\r\\n\\r\\nINSERT INTO trips_part PARTITION(month=11) SELECT bikeid,checkout_time,duration_minutes,end_station_id,end_station_name,start_station_id,start_station_name,start_time,subscriber_type,trip_id,\\tyear_modif FROM trips_ok WHERE month_modif = 11;\\r\\n\\r\\nselect month, count(*) from trips group by month;\\r\\n\\r\\nselect month, count(*) from trips_part group by month;\\r\\n\\r\\nDROP TABLE flightdelays_part;\\r\\nCREATE EXTERNAL TABLE flightdelays_part(\\r\\n    year INT,\\r\\n    day INT,\\r\\n    day_of_week INT,\\r\\n    dep_time INT,\\r\\n    crs_dep_time INT,\\r\\n    arr_time INT,\\r\\n    crs_arr_time INT,\\r\\n    unique_carrier STRING,\\r\\n    flight_num INT,\\r\\n    tail_num STRING,\\r\\n    actual_elapsed_time INT,\\r\\n    crs_elapsed_time INT,\\r\\n    air_time INT,\\r\\n    arr_delay INT,\\r\\n    dep_delay INT,\\r\\n    dest STRING,\\r\\n    distance INT,\\r\\n    taxi_in INT,\\r\\n    taxi_out INT,\\r\\n    cancelled INT,\\r\\n    cancellation_code STRING,\\r\\n    diverted INT,\\r\\n    carrier_delay STRING,\\r\\n    weather_delay STRING,\\r\\n    nas_delay STRING,\\r\\n    security_delay STRING,\\r\\n    late_aircraft_delay STRING\\r\\n)\\r\\nPARTITIONED BY(month INT, origin STRING)\\r\\nROW FORMAT DELIMITED\\r\\nFIELDS TERMINATED BY ','\\r\\nLOCATION '/user/instructor/data/flights/flightdelays_part/';\\r\\n\\r\\nINSERT INTO flightdelays_part\\r\\nPARTITION(month=1, origin='ABQ')\\r\\nSELECT year,\\r\\n    day,\\r\\n    day_of_week,\\r\\n    dep_time,\\r\\n    crs_dep_time,\\r\\n    arr_time,\\r\\n    crs_arr_time,\\r\\n    unique_carrier,\\r\\n    flight_num,\\r\\n    tail_num,\\r\\n    actual_elapsed_time,\\r\\n    crs_elapsed_time,\\r\\n    air_time,\\r\\n    arr_delay,\\r\\n    dep_delay,\\r\\n    dest,\\r\\n    distance,\\r\\n    taxi_in,\\r\\n    taxi_out,\\r\\n    cancelled,\\r\\n    cancellation_code,\\r\\n    diverted,\\r\\n    carrier_delay,\\r\\n    weather_delay,\\r\\n    nas_delay,\\r\\n    security_delay,\\r\\n    late_aircraft_delay\\r\\nFROM flightdelays\\r\\nWHERE month = 1\\r\\nAND origin = 'ABQ';\\r\\n--AND origin = 'ALB';\\r\\n--AND origin = 'AMA';\\r\\n--AND origin = 'AUS';\\r\\n\\r\\nselect distinct month, origin from flightdelays_part;\\r\\n\\r\\nDESCRIBE FORMATTED flightdelays_part;\\r\\n\\r\\nSELECT * FROM flightdelays_part WHERE month = 1 LIMIT 20;\\r\\n\\r\\nSELECT origin, count(*)\\r\\nFROM flightdelays_part\\r\\nGROUP BY origin;\\r\\n\\r\\nSELECT dest, count(*)\\r\\nFROM flightdelays_part\\r\\nGROUP BY dest;\", \"lastExecutedStatements\": \"select * from trips_part where month = 12;\", \"aceErrorsHolder\": [], \"showOptimizer\": false, \"currentQueryTab\": \"queryHistory\", \"lastCheckStatusRequest\": {\"status\": 200, \"statusText\": \"OK\", \"readyState\": 4, \"responseJSON\": {\"status\": 0, \"query_status\": {\"status\": \"available\", \"has_result_set\": true}}, \"responseText\": \"{\\\"status\\\": 0, \\\"query_status\\\": {\\\"status\\\": \\\"available\\\", \\\"has_result_set\\\": true}}\"}, \"jobs\": [], \"statementType\": \"text\", \"variableValues\": {}, \"executeNextTimeout\": -1, \"queriesTotalPages\": 1, \"formatEnabled\": true, \"properties\": {\"files\": [], \"functions\": [], \"arguments\": [], \"settings\": []}, \"aceErrors\": [], \"isCanceling\": false, \"externalStatementLoaded\": false, \"chartScatterSize\": null, \"chartYSingle\": \"trips_part.duration_minutes\", \"suggestion\": \"\", \"statementPath\": \"\", \"showExecutionAnalysis\": true, \"chartX\": \"trips_part.checkout_time\", \"autocompleteSettings\": {\"temporaryOnly\": false}, \"variables\": [], \"showChart\": false, \"isResultSettingsVisible\": true, \"showGrid\": true, \"pinnedContextTabs\": [], \"viewSettings\": {\"sqlDialect\": true, \"placeHolder\": \"Ejemplo: SELECT * FROM nombre de tabla o pulse CTRL + espacio\"}, \"statementsList\": [\"-- FLIGHT DELAYS\\r\\n-- http://stat-computing.org/dataexpo/2009/the-data.html\\r\\n\\r\\nDROP TABLE flightdelays;\", \"\\r\\nCREATE EXTERNAL TABLE flightdelays(\\r\\n    year INT,\\r\\n    month INT,\\r\\n    day INT,\\r\\n    day_of_week INT,\\r\\n    dep_time INT,\\r\\n    crs_dep_time INT,\\r\\n    arr_time INT,\\r\\n    crs_arr_time INT,\\r\\n    unique_carrier STRING,\\r\\n    flight_num INT,\\r\\n    tail_num STRING,\\r\\n    actual_elapsed_time INT,\\r\\n    crs_elapsed_time INT,\\r\\n    air_time INT,\\r\\n    arr_delay INT,\\r\\n    dep_delay INT,\\r\\n    origin STRING,\\r\\n    dest STRING,\\r\\n    distance INT,\\r\\n    taxi_in INT,\\r\\n    taxi_out INT,\\r\\n    cancelled INT,\\r\\n    cancellation_code STRING,\\r\\n    diverted INT,\\r\\n    carrier_delay STRING,\\r\\n    weather_delay STRING,\\r\\n    nas_delay STRING,\\r\\n    security_delay STRING,\\r\\n    late_aircraft_delay STRING\\r\\n)\\r\\nROW FORMAT DELIMITED\\r\\nFIELDS TERMINATED BY ','\\r\\nLOCATION '/user/instructor/data/flights/flightdelays/';\", \"\\r\\n\\r\\nSELECT count(*) FROM flightdelays;\", \"\\r\\n\\r\\nshow tables;\", \"\\r\\n-- AIRPORTS\\r\\n-- http://stat-computing.org/dataexpo/2009/supplemental-data.html\\r\\nDROP TABLE airports;\", \"\\r\\nCREATE EXTERNAL TABLE airports(\\r\\n    iata STRING,\\r\\n    airport STRING,\\r\\n    city STRING,\\r\\n    state STRING,\\r\\n    country STRING,\\r\\n    lat DECIMAL(9,6),\\r\\n    long DECIMAL(9,6)\\r\\n)\\r\\nROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde'\\r\\nWITH SERDEPROPERTIES (\\r\\n    'separatorChar'=',',\\r\\n    'quoteChar'='\\\\\\\"',\\r\\n    'skip.header.line.count'='1'\\r\\n)\\r\\nLOCATION '/user/instructor/data/flights/airports/';\", \"\\r\\n\\r\\nSELECT count(*) FROM airports;\", \"\\r\\n\\r\\nSHOW TABLES;\", \"\\r\\n\\r\\nDESCRIBE FORMATTED airports;\", \"\\r\\n\\r\\nSELECT \\r\\n    ROUND(AVG(arr_delay), 2) AS avg_sfo_delay_min \\r\\nFROM \\r\\n    flightdelays \\r\\nWHERE \\r\\n    month=1 AND origin='SFO';\", \"\\r\\n\\r\\nSELECT \\r\\n    a.airport,\\r\\n    ROUND(AVG(f.arr_delay), 2) AS avg_delay_min \\r\\nFROM \\r\\n    flightdelays f \\r\\n    JOIN airports a ON f.origin = a.iata\\r\\nWHERE \\r\\n    month = 1\\r\\nGROUP BY\\r\\n    a.airport\\r\\nLIMIT 5;\"], \"lastAceSelectionRowOffset\": 245, \"executingBlockingOperation\": null, \"errorsKlass\": \"results hive alert alert-error\", \"statement\": \"-- FLIGHT DELAYS\\r\\n-- http://stat-computing.org/dataexpo/2009/the-data.html\\r\\n\\r\\nDROP TABLE flightdelays;\", \"type\": \"hive\", \"chartSorting\": \"desc\", \"previousChartOptions\": {\"chartTimelineType\": \"bar\", \"chartSorting\": \"desc\", \"chartLimit\": null, \"chartMapHeat\": null, \"chartX\": \"trips_part.checkout_time\", \"chartMapType\": \"marker\", \"chartYMulti\": [], \"chartScatterSize\": null, \"chartScope\": \"world\", \"chartMapLabel\": null, \"chartScatterGroup\": null, \"chartYSingle\": \"trips_part.duration_minutes\", \"chartXPivot\": \"apachelogs.host\"}, \"aceWarningsHolder\": [], \"resultsKlass\": \"results hive\", \"chartTimelineType\": \"bar\", \"compatibilityTargetPlatforms\": [{\"name\": \"Impala\", \"value\": \"impala\"}, {\"name\": \"Hive\", \"value\": \"hive\"}], \"topRisk\": null, \"compute\": {\"name\": \"default\", \"namespace\": \"default\", \"id\": \"default\", \"interface\": \"hive\", \"type\": \"direct\", \"options\": {}}, \"hasCurlyBracketParameters\": true, \"chartScatterGroup\": null, \"settingsVisible\": false, \"queriesFilterVisible\": false, \"aceAutoExpand\": false, \"aceWarnings\": [], \"compatibilityCheckRunning\": false, \"isLoading\": false, \"loadingQueries\": false, \"hasDataForChart\": true, \"id\": \"a84d2837-d6a6-78ea-6cee-89b387667725\", \"aceSize\": 100, \"chartData\": [], \"namespace\": {\"status\": \"CREATED\", \"computes\": [{\"credentials\": {}, \"type\": \"direct\", \"id\": \"default\", \"name\": \"default\"}], \"id\": \"default\", \"name\": \"default\"}, \"queriesHasErrors\": false, \"chartMapLabel\": null, \"editorMode\": true, \"status\": \"available\", \"isSqlDialect\": true, \"chartMapType\": \"marker\", \"queriesFilter\": \"\", \"queriesCurrentPage\": 1, \"isBatchable\": true, \"chartYMulti\": [], \"dbSelectionVisible\": false, \"database\": \"default\", \"hasSuggestion\": null, \"chartXPivot\": \"apachelogs.host\", \"checkStatusTimeout\": null}], \"historyTotalPages\": 0, \"onSuccessUrl\": null, \"id\": 4, \"historyFilterVisible\": false, \"historyFilter\": \"\", \"description\": \"\", \"historyCurrentPage\": 1, \"isManaged\": false, \"isBatchable\": true, \"isExecutingAll\": false, \"isHidingCode\": false, \"loadingScheduler\": false, \"isPresentationModeInitialized\": true, \"parentSavedQueryUuid\": \"e66178aa-0d51-45e0-9e95-32f706d3e52a\"}",
    "extra": "",
    "search": "-- FLIGHT DELAYS\r\n-- http://stat-computing.org/dataexpo/2009/the-data.html\r\n\r\nDROP TABLE flightdelays;\r\nCREATE EXTERNAL TABLE flightdelays(\r\n    year INT,\r\n    month INT,\r\n    day INT,\r\n    day_of_week INT,\r\n    dep_time INT,\r\n    crs_dep_time INT,\r\n    arr_time INT,\r\n    crs_arr_time INT,\r\n    unique_carrier STRING,\r\n    flight_num INT,\r\n    tail_num STRING,\r\n    actual_elapsed_time INT,\r\n    crs_elapsed_time INT,\r\n    air_time INT,\r\n    arr_delay INT,\r\n    dep_delay INT,\r\n    origin STRING,\r\n    dest STRING,\r\n    distance INT,\r\n    taxi_in INT,\r\n    taxi_out INT,\r\n    cancelled INT,\r\n    cancellation_code STRING,\r\n    diverted INT,\r\n    carrier_delay STRING,\r\n    weather_delay STRING,\r\n    nas_delay STRING,\r\n    security_delay STRING,\r\n    late_aircraft_delay STRING\r\n)\r\nROW FORMAT DELIMITED\r\nFIELDS TERMINATED BY ','\r\nLOCATION '/user/instructor/data/flights/flightdelays/';\r\n\r\nSELECT count(*) FROM flightdelays;\r\n\r\nshow tables;\r\n-- AIRPORTS\r\n-- http://stat-computing.org/dataexpo/2009/supplemental-data.html\r\nDROP TABLE airports;\r\nCREATE EXTERNAL TABLE airports(\r\n    iata STRING,\r\n    airport STRING,\r\n    city STRING,\r\n    state STRING,\r\n    country STRING,\r\n    lat DECIMAL(9,6),\r\n    long DECIMAL(9,6)\r\n)\r\nROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde'\r\nWITH SERDEPROPERTIES (\r\n    'separatorChar'=',',\r\n    'quoteChar'='\\\"',\r\n    'skip.header.line.count'='1'\r\n)\r\nLOCATION '/user/instructor/data/flights/airports/';\r\n\r\nSELECT count(*) FROM airports;\r\n\r\nSHOW TABLES;\r\n\r\nDESCRIBE FORMATTED airports;\r\n\r\nSELECT \r\n    ROUND(AVG(arr_delay), 2) AS avg_sfo_delay_min \r\nFROM \r\n    flightdelays \r\nWHERE \r\n    month=1 AND origin='SFO';\r\n\r\nSELECT \r\n    a.airport,\r\n    ROUND(AVG(f.arr_delay), 2) AS avg_delay_min \r\nFROM \r\n    flightdelays f \r\n    JOIN airports a ON f.origin = a.iata\r\nWHERE \r\n    month = 1\r\nGROUP BY\r\n    a.airport\r\nLIMIT 5;\r\n\r\n\r\n-- CTAS\r\n\r\n\r\nCREATE TABLE flightdelays_sfo \r\nAS\r\nSELECT\r\n    dep_time, \r\n    unique_carrier, \r\n    flight_num, \r\n    arr_delay, \r\n  ",
    "last_modified": "2022-08-04T15:39:07.716",
    "version": 1,
    "is_history": false,
    "is_managed": false,
    "is_trashed": false,
    "parent_directory": [
      "b27825b4-51ce-494e-8554-67e2dfcf5f98",
      1,
      false
    ],
    "dependencies": []
  }
}
]
